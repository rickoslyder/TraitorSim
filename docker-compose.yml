version: '3.8'

services:
  agent-0:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-0
    environment:
      - PLAYER_ID=player_00
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-1:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-1
    environment:
      - PLAYER_ID=player_01
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-2:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-2
    environment:
      - PLAYER_ID=player_02
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-3:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-3
    environment:
      - PLAYER_ID=player_03
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-4:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-4
    environment:
      - PLAYER_ID=player_04
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-5:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-5
    environment:
      - PLAYER_ID=player_05
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-6:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-6
    environment:
      - PLAYER_ID=player_06
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-7:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-7
    environment:
      - PLAYER_ID=player_07
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-8:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-8
    environment:
      - PLAYER_ID=player_08
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-9:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-9
    environment:
      - PLAYER_ID=player_09
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-10:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-10
    environment:
      - PLAYER_ID=player_10
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-11:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-11
    environment:
      - PLAYER_ID=player_11
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-12:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-12
    environment:
      - PLAYER_ID=player_12
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-13:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-13
    environment:
      - PLAYER_ID=player_13
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-14:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-14
    environment:
      - PLAYER_ID=player_14
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-15:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-15
    environment:
      - PLAYER_ID=player_15
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-16:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-16
    environment:
      - PLAYER_ID=player_16
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-17:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-17
    environment:
      - PLAYER_ID=player_17
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-18:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-18
    environment:
      - PLAYER_ID=player_18
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-19:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-19
    environment:
      - PLAYER_ID=player_19
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-20:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-20
    environment:
      - PLAYER_ID=player_20
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-21:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-21
    environment:
      - PLAYER_ID=player_21
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-22:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-22
    environment:
      - PLAYER_ID=player_22
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  agent-23:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: traitorsim-agent-23
    environment:
      - PLAYER_ID=player_23
      - PORT=5000
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
    mem_limit: 1g
    cpus: 1.0
    volumes:
      - ./data/memories:/app/data/memories
      - ./data/personas:/app/data/personas
    networks:
      - traitorsim
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 10s
      timeout: 5s
      retries: 3

  game-engine:
    build:
      context: .
      dockerfile: Dockerfile.game-engine
    container_name: traitorsim-game-engine
    environment:
      - GEMINI_API_KEY=${GEMINI_API_KEY}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
    volumes:
      - ./data:/app/data
    networks:
      - traitorsim
    depends_on:
      - agent-0
      - agent-1
      - agent-2
      - agent-3
      - agent-4
      - agent-5
      - agent-6
      - agent-7
      - agent-8
      - agent-9
      - agent-10
      - agent-11
      - agent-12
      - agent-13
      - agent-14
      - agent-15
      - agent-16
      - agent-17
      - agent-18
      - agent-19
      - agent-20
      - agent-21
      - agent-22
      - agent-23

networks:
  traitorsim:
    driver: bridge
