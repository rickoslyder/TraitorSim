# Dockerfile for containerized player agent
FROM python:3.12-slim

# Install system dependencies for health checks
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

# Install Python dependencies
RUN pip install --no-cache-dir \
    anthropic>=0.40.0 \
    claude-agent-sdk>=0.1.0 \
    google-genai>=1.56.0 \
    numpy>=1.26.0 \
    python-dotenv>=1.0.0 \
    flask>=3.0.0

# Set working directory
WORKDIR /app

# Copy TraitorSim source code
COPY src/ /app/src/

# Create data directory structure
RUN mkdir -p /app/data/memories

# Set environment variables
ENV PYTHONUNBUFFERED=1
ENV PYTHONPATH=/app

# Expose Flask port
EXPOSE 5000

# Run agent service
CMD ["python3", "-m", "src.traitorsim.agents.agent_service"]
